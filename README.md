It's not pretty, but it works(?).
